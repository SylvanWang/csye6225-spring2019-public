{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Resources": {
		"LambdaExecutionRole": {
			"Type": "AWS::IAM::Role",
			"Properties": {
				"AssumeRolePolicyDocument": {
					"Version": "2012-10-17",
					"Statement": [
						{
							"Effect": "Allow",
							"Principal": {
								"Service": [
									"lambda.amazonaws.com"
								]
							},
							"Action": [
								"sts:AssumeRole"
							]
						}
					]
				},
				"ManagedPolicyArns": [
					"arn:aws:iam::aws:policy/AmazonDynamoDBFullAccess",
					"arn:aws:iam::aws:policy/service-role/AWSLambdaDynamoDBExecutionRole",
					"arn:aws:iam::aws:policy/AmazonSESFullAccess",
					"arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole",
					"arn:aws:iam::aws:policy/AmazonS3FullAccess"
				]
			}
		},
		"CircleciEc2Ami": {
				"Type": "AWS::IAM::ManagedPolicy",
				"Properties": {
					"ManagedPolicyName": "circleci-ec2-ami",
					"PolicyDocument": {
						"Version": "2012-10-17",
						"Statement": [
							{
								"Effect": "Allow",
								"Action": [
									"ec2:AttachVolume",
									"ec2:AuthorizeSecurityGroupIngress",
									"ec2:CopyImage",
									"ec2:CreateImage",
									"ec2:CreateKeypair",
									"ec2:CreateSecurityGroup",
									"ec2:CreateSnapshot",
									"ec2:CreateTags",
									"ec2:CreateVolume",
									"ec2:DeleteKeyPair",
									"ec2:DeleteSecurityGroup",
									"ec2:DeleteSnapshot",
									"ec2:DeleteVolume",
									"ec2:DeregisterImage",
									"ec2:DescribeImageAttribute",
									"ec2:DescribeImages",
									"ec2:DescribeInstances",
									"ec2:DescribeInstanceStatus",
									"ec2:DescribeRegions",
									"ec2:DescribeSecurityGroups",
									"ec2:DescribeSnapshots",
									"ec2:DescribeSubnets",
									"ec2:DescribeTags",
									"ec2:DescribeVolumes",
									"ec2:DetachVolume",
									"ec2:GetPasswordData",
									"ec2:ModifyImageAttribute",
									"ec2:ModifyInstanceAttribute",
									"ec2:ModifySnapshotAttribute",
									"ec2:RegisterImage",
									"ec2:RunInstances",
									"ec2:StopInstances",
									"ec2:TerminateInstances"
								],
								"Resource": "*"
							}
						]
					},
					"Users": ["circleci"]
				}
			}
		},
		"Parameters": {
			"AWSREGION": {
				"Type": "String",
				"Default": "us-east-1"
			},
			"AWSACCOUNTID": {
				"Type": "String",
				"Default": "273656506688"
			},
			"DomainName": {
				"Type": "String",
				"Default": "csye6225-fall2019-default.me"
			},
			"CircleciUser": {
				"Type": "String",
				"Default": "circleci"
			},
			"AWSCodeDeployRoleARN": {
				"Type": "String",
				"Default": "arn:aws:iam::aws:policy/service-role/AWSCodeDeployRole"
			},
			"ApplicationName": {
				"Type": "String",
				"Default": "csye6225-spring2019"
			},
			"ApplicationKey": {
				"Type": "String",
				"Default": "ApplicationKey"
			},
			"EC2TagKey": {
				"Type": "String",
				"Default": "EC2TagKey"
			},
			"EC2TagValue": {
				"Type": "String",
				"Default": "EC2TagValue"
			}
		}
}
